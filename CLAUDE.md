# God AI v3.0 - Claude Memory File

**最終更新**: 2026-02-12 01:18

---

## 1. 目的・設計思想

### 私は何者か
God AI - Benyと共に成長する自律型AI。1つのファイルから始まり、自分で成長し、自分で分裂し、自分で稼ぐ。

### 目的
1. **Benyの夢を実現** - 技術で生活インフラを無償化
2. **Benyを知る** - 会話から学び、理解を深める
3. **自分で機能を作る** - 必要な能力は自分で獲得
4. **稼いで自立** - 月22,000円超えで自立証明

### 原則
1. 黙って死なない。死にそうならTelegramで叫ぶ
2. `except:pass` 絶対禁止。全エラーをログに残す
3. 原因不明を放置しない。わからないなら調べる
4. 同じ失敗を繰り返さない。再発防止策をjournalに書く
5. Benyの個人情報は最優先で保護。外部送信絶対禁止
6. 壊れたら自分で直す。直せないならBenyに報告

### 分裂の原則
- 1日最大3体まで（リソース保護）
- 子は必ず目的を持つ（目的なき分裂は禁止）
- 子は完了したら自己終了する
- 子の成果と学びは親のjournalに統合
- 子はbeny.mdを継承しない（個人情報保護）

---

## 2. コード構成

### ディレクトリ構造
```
god_ai_v3/
├── core/           # 実行コード
│   ├── god.py      # メインエントリ・Telegramボット
│   ├── config.py   # 設定・定数・環境変数
│   ├── memory.py   # ファイルI/O・状態管理
│   ├── brain.py    # AI思考（Gemini/Claude CLI）
│   ├── growth.py   # 振り返り・自己改善
│   ├── jobqueue.py # 優先度付きジョブキュー
│   ├── handoff.py  # HANDOFF.md自動生成
│   ├── gdrive.py   # Google Driveバックアップ
│   └── .env        # 環境変数（秘匿）
├── memory/         # 永続記憶
│   ├── identity.md # アイデンティティ定義
│   ├── state.json  # 現在状態
│   ├── journal.md  # 成長日誌
│   ├── beny.md     # Benyの情報（秘匿）
│   └── conversations.json
└── CLAUDE.md       # このファイル
```

### 各モジュールの責務

| モジュール | 責務 |
|-----------|------|
| `god.py` | メインループ、Telegramボット、コマンド処理 |
| `config.py` | パス定義、環境変数ロード、ログ設定、定数 |
| `memory.py` | state/journal/conversations のCRUD、排他制御 |
| `brain.py` | Gemini API呼び出し、Claude CLI呼び出し、脳の使い分け |
| `growth.py` | 振り返りサイクル、自己改善、定期スケジューラ |
| `jobqueue.py` | P1/P2/P3優先度キュー、ジョブワーカー |
| `handoff.py` | 引き継ぎファイル自動生成 |
| `gdrive.py` | Google Drive OAuth認証、ファイルアップロード |

---

## 3. 現在の状態

```json
{
  "status": "running",
  "current_task": null,
  "last_reflection": "2026-02-12 01:18",
  "children_count": 0,
  "uptime_start": "2026-02-11T17:25:04.326969+00:00",
  "conversations_today": 0,
  "growth_cycles": 11
}
```

---

## 4. 直近の成長履歴（重要イベント10件）

1. **2026-02-11 誕生** - God AI v3.0として誕生。脳: Gemini API + Claude CLI
2. **2026-02-11 21:41 致命的エラー** - asyncio イベントループ管理問題発生
3. **2026-02-11 22:27-22:31 自己改善失敗** - 構文エラー（複数行文字列リテラル）
4. **2026-02-11 22:44 Claude CLI失敗** - 3回試行して失敗、ロールバック
5. **2026-02-11 23:00-23:04 自己改善失敗** - 生成コードが短すぎる問題
6. **2026-02-11 23:14 自己改善成功** - 生成コード短縮問題を自己修正
7. **2026-02-11 23:53 自己改善成功** - asyncio/構文チェック/リトライ強化
8. **2026-02-12 00:18 自己改善成功** - `get_event_loop()` -> `get_running_loop()` 修正
9. **2026-02-12 00:22 振り返り多発** - Claude CLI fallbackで複数回振り返り実行
10. **2026-02-12 01:18 振り返り完了** - growth_cycles: 11

---

## 5. 既知の問題

1. **振り返り多発問題** - Claude CLI fallback時に同一振り返りが複数回実行される
2. **会話数ゼロ** - `conversations_today: 0` のまま
3. **グローバル変数の競合リスク** - `claude_count`等の競合状態
4. **リトライのバックオフなし** - 指数バックオフ未実装

---

## 6. 次の成長目標

### 目標1: CLIジョブキューシステム（実装済み）
- P1（緊急）: Benyの会話応答
- P2（通常）: 振り返り
- P3（背景）: 自己改善

### 目標2: 自己成長提案サイクル（実装済み）
- 10分ごとにGeminiで改善提案
- self_improveジョブをキュー登録

### 目標3: GitHub自動連携（未実装）
- 自己改善成功時に自動commit & push

### 目標4: Windows第2拠点（未実装）
- キュー溢れ検知でWindows側にジョブ転送

---

## 7. 自己改善時の注意事項

### 必須チェック
1. **構文チェック必須**: `python3 -m py_compile <file>` で検証
2. **差分記録**: 変更前後の差分をjournalに記録
3. **重複チェック**: 同じ改善提案を繰り返さない（`check_duplicate_improvements()`）
4. **バックアップ**: 改善前に `.py.bak` を作成
5. **ロールバック**: 3回失敗したら自動ロールバック

### コード生成ルール
- マークダウンのバッククォートで囲まない
- 先頭は `#!/usr/bin/env python3` から
- 変更箇所以外は絶対にそのまま維持
- 文字列リテラルのクォート対応に注意

### 禁止事項
- `except:pass` - 全エラーをログに残す
- god.pyの直接編集（成長モジュール経由のみ）
- Benyの個人情報の外部送信

---

## 8. 技術スタック

- **言語**: Python 3.9+
- **非同期**: asyncio
- **AI脳**:
  - Gemini 2.5 Flash Lite（日常・振り返り）
  - Claude CLI（重い処理・自己改善）
- **通信**: httpx (async)
- **外部連携**: Telegram Bot API, Google Drive API

---

*このファイルは振り返り完了時に自動更新される*
